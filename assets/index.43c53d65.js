import{M as L,a as B,S as D,P as Y,W as G,b as j,A as V,c as I,T as K}from"./vendor.8222db3a.js";const N=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function s(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerpolicy&&(n.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?n.credentials="include":i.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(i){if(i.ep)return;i.ep=!0;const n=s(i);fetch(i.href,n)}};N();Element.prototype.addClass=function(e){this.classList.contains(e)||this.classList.add(e)};Element.prototype.removeClass=function(e){this.classList.contains(e)&&this.classList.remove(e)};Array.prototype.first=function(){return this[0]};Array.prototype.last=function(){return this[this.length-1]};document.querySelectorAll(".inputslider").forEach(e=>{let t=e.dataset.values.split(",");parseFloat(e.dataset.value);let s="",r=parseFloat(t.first()),i=parseFloat(t.last()),n=e.querySelector("input"),a=e.querySelector(".area"),o=e.querySelector(".knob");e.querySelector(".fill"),e.dataset.unit&&(s=e.dataset.unit),t.forEach((h,c)=>{t[c]=h=parseFloat(h);let l=document.createElement("span");l.innerText=h+s,l.setAttribute("data-value",h),c==0&&(l.addClass("selected"),n.value=h),l.style.left=gsap.utils.mapRange(r,i,0,100,h)+"%",e.querySelector(".values").appendChild(l)}),Draggable.create(o,{type:"x",edgeResistance:1,bounds:a,throwProps:!1,onDrag:function(){P(this,!1)},onDragEnd:function(){P(this,!0)}})});function P(e,t){let s=e.target.closest(".inputslider"),r=s.querySelector(".fill"),i=s.dataset.values.split(","),n=parseFloat(i.first()),a=parseFloat(i.last()),o=gsap.utils.mapRange(0,e.maxX,0,100,e.x),h=gsap.utils.mapRange(0,e.maxX,n,a,e.x),c=gsap.utils.snap(i,h),l=gsap.utils.mapRange(n,a,0,e.maxX,c),k=gsap.utils.mapRange(0,e.maxX,0,100,l);t?(gsap.to(e.target,{duration:.2,x:l}),gsap.to(r,{duration:.2,width:k+"%"})):(i.forEach((w,O)=>{i[O]=parseFloat(w)}),r.style.width=o+"%",s.querySelectorAll(".values span").forEach(w=>{parseFloat(w.dataset.value)==c?w.addClass("selected"):w.removeClass("selected")}),s.querySelector("input").value=c)}function Z(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)}let b=document.getElementById("speedSlider");var v=.001;class J{constructor(t,s,r,i,n,a){this.scientist=r,this.influence=i,this.originX=n,this.originY=a,this.partner=null,this.publisher=null,this.geometry=s,this.material=new L({wireframe:!0}),this.mesh=new B(s,this.material),this.update_color(),this.mesh.position.x=n,this.mesh.position.y=a,this.mesh.name="agent",t.add(this.mesh)}move(){this.publisher!=null?(this.moveTowards(this.publisher),this.atEntity(this.publisher)&&this.read()):this.partner!=null?(this.moveTowards(this.partner),this.atEntity(this.partner)&&this.talk()):(this.mesh.position.x+=(this.originX-this.mesh.position.x)/80*b.querySelector("input").value,this.mesh.position.y+=(this.originY-this.mesh.position.y)/80*b.querySelector("input").value,this.mesh.rotation.y+=.01)}moveTowards(t){Math.abs(this.mesh.position.x-t.mesh.position.x)>1&&(this.mesh.position.x+=(t.mesh.position.x-this.mesh.position.x)/50*b.querySelector("input").value),Math.abs(this.mesh.position.y-t.mesh.position.y)>1&&(this.mesh.position.y+=(t.mesh.position.y-this.mesh.position.y)/50*b.querySelector("input").value)}atEntity(t){return Math.abs(this.mesh.position.x-t.mesh.position.x)<=1&&Math.abs(this.mesh.position.y-t.mesh.position.y)<=1}atOrigin(){return Math.abs(this.mesh.position.x-this.originX)<=1&&Math.abs(this.mesh.position.y-this.originY)<=1}read(){var t=this.publisher.publish();t==1?this.scientist?this.influence+=30*v*(this.influence+1):this.influence+=10*v*(this.influence+1):this.scientist?this.influence-=5*v*(this.influence+1):this.influence-=15*v*(this.influence+1)}talk(){var t,s;this.influence<0?t=-1*(1-Math.abs(this.influence)):t=1-this.influence,this.partner.influence<0?s=-1*(1-Math.abs(this.partner.influence)):s=1-this.partner.influence,this.influence+=s*v,this.partner.influence+=t*v,this.partner=null}update_color(){this.influence<-1?this.influence=-1:this.influence>1&&(this.influence=1);var t=this.influence/2+.5;this.color=gsap.utils.interpolate("red","green",t),this.material.color.set(this.color)}}class Q{constructor(t,s,r,i,n,a){this.science_ratio=r,this.posX=t,this.posY=s,this.releases=[];for(var o=0;o<this.science_ratio[0];o++)this.releases.push(1);for(var o=0;o<this.science_ratio[1];o++)this.releases.push(0);this.geometry=n,this.material=a,this.mesh=new B(n,a),this.mesh.name="publisher",this.mesh.position.x=t,this.mesh.position.y=s,i.add(this.mesh)}publish(){return this.releases[Math.round(Math.random()*(this.releases.length-1))]}}let d=document.getElementById("agentSlider"),E=document.getElementById("daySlider"),q=document.getElementById("criticalSlider"),M=document.getElementById("misinformationSlider");function U(){var e=document.getElementById("dayBar");m>=S&&F()&&(g=!1,document.getElementById("startBtn").innerHTML="Start"),e.style.width=Math.round(m/S*100)+"%",e.innerHTML="day "+m}function $(){var e=document.getElementById("misinformedBar"),t=f.filter(r=>r.influence<-.15).length,s=Math.round(t/d.querySelector("input").value*100)+"%";e.style.width=s,e.innerHTML="misinformed "+s}var u=new D,p=new Y(90,window.innerWidth/window.innerHeight,.1,5e3),y=new G({canvas:document.querySelector("#sim-canvas")});y.setClearColor("#666666",.2);y.setPixelRatio(window.devicePixelRatio);y.setSize(window.innerWidth,window.innerHeight);p.position.setZ(30);p.position.setX(-3);y.render(u,p);var R=new j(16777215);R.position.set(10,10,10);var ee=new V(16777215,.9);u.add(R,ee);var te=new I(2,3,3),ie=new I(2,3,3),se=new K(10,10,7,11),re=new L({color:16725401,wireframe:!0});function T(){var e=0,t=0,s=parseInt(M.querySelector("input").value),r=[100-s,s],i=new Q(e,t,r,u,se,re);return i}function A(e){for(var t=[],s=[],r=0;r<e;r++)s.push(2*Math.PI/e*r-Math.PI);for(var r=0;r<e;r++){let c=Math.sin(s[r])*e,l=Math.cos(s[r])*e;var i=0,n=!1,a=te;Math.floor(r/e*100)<parseInt(q.querySelector("input").value)&&(n=!0,a=ie);var o=new J(u,a,n,i,c,l);t.push(o)}return t}function ne(e){const t=Math.random();t<.33?e.publisher=_:t<.66&&(e.partner=f[Z(0,d.querySelector("input").value)])}function F(){return!f.some(e=>!e.atOrigin())}function X(e){for(let t=u.children.length-1;t>=0;t--)u.children[t].name==e&&u.remove(u.children[t])}function C(){X("agent"),f=A(d.querySelector("input").value),m=0}var f=A(d.querySelector("input").value),m=0,g=!1;document.getElementById("startBtn").addEventListener("click",function(){m>=S&&C(),g?(document.getElementById("startBtn").innerHTML="Start",g=!1):(document.getElementById("startBtn").innerHTML="Stop",g=!0)});var x=d.querySelector("input").value,H=q.querySelector("input").value,S=E.querySelector("input").value,W=M.querySelector("input").value;p.position.z=gsap.utils.mapRange(0,400,10,500,x);var _=T();function z(){requestAnimationFrame(z),(d.querySelector("input").value!=x||q.querySelector("input").value!=H)&&(x=d.querySelector("input").value,H=q.querySelector("input").value,p.position.z=gsap.utils.mapRange(0,400,10,500,x),C()),E.querySelector("input").value!=S&&(S=E.querySelector("input").value),M.querySelector("input").value!=W&&(W=M.querySelector("input").value,X("publisher"),_=T()),F()&&g&&m<=S&&(m+=1,f.map(e=>ne(e))),g?f.map(e=>{e.move(),e.update_color(),e.publisher!=null&&e.atEntity(e.publisher)&&(e.publisher=null)}):f.map(e=>{e.mesh.rotation.x+=.01}),U(),$(),console.log(f[0].influence),_.mesh.rotation.y+=.001,_.mesh.rotation.z+=.005,y.render(u,p)}function ae(){p.aspect=window.innerWidth/window.innerHeight,p.updateProjectionMatrix(),y.setSize(window.innerWidth,window.innerHeight)}window.addEventListener("resize",ae,!1);z();
