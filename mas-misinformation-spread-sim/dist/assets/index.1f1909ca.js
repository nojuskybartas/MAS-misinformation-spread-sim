import{M as B,a as P,S as G,P as N,W as V,b as K,A as Z,c as R,T as J}from"./vendor.8222db3a.js";const Q=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerpolicy&&(n.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?n.credentials="include":i.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=r(i);fetch(i.href,n)}};Q();Element.prototype.addClass=function(e){this.classList.contains(e)||this.classList.add(e)};Element.prototype.removeClass=function(e){this.classList.contains(e)&&this.classList.remove(e)};Array.prototype.first=function(){return this[0]};Array.prototype.last=function(){return this[this.length-1]};document.querySelectorAll(".inputslider").forEach(e=>{let t=e.dataset.values.split(",");parseFloat(e.dataset.value);let r="",s=parseFloat(t.first()),i=parseFloat(t.last()),n=e.querySelector("input"),a=e.querySelector(".area"),o=e.querySelector(".knob");e.querySelector(".fill"),e.dataset.unit&&(r=e.dataset.unit),t.forEach((h,p)=>{t[p]=h=parseFloat(h);let l=document.createElement("span");l.innerText=h+r,l.setAttribute("data-value",h),p==0&&(l.addClass("selected"),n.value=h),l.style.left=gsap.utils.mapRange(s,i,0,100,h)+"%",e.querySelector(".values").appendChild(l)}),Draggable.create(o,{type:"x",edgeResistance:1,bounds:a,throwProps:!1,onDrag:function(){T(this,!1)},onDragEnd:function(){T(this,!0)}})});function T(e,t){let r=e.target.closest(".inputslider"),s=r.querySelector(".fill"),i=r.dataset.values.split(","),n=parseFloat(i.first()),a=parseFloat(i.last()),o=gsap.utils.mapRange(0,e.maxX,0,100,e.x),h=gsap.utils.mapRange(0,e.maxX,n,a,e.x),p=gsap.utils.snap(i,h),l=gsap.utils.mapRange(n,a,0,e.maxX,p),Y=gsap.utils.mapRange(0,e.maxX,0,100,l);t?(gsap.to(e.target,{duration:.2,x:l}),gsap.to(s,{duration:.2,width:Y+"%"})):(i.forEach((S,j)=>{i[j]=parseFloat(S)}),s.style.width=o+"%",r.querySelectorAll(".values span").forEach(S=>{parseFloat(S.dataset.value)==p?S.addClass("selected"):S.removeClass("selected")}),r.querySelector("input").value=p)}function A(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)}function E(e){var t=Number(e).toString(16);return t.length<2&&(t="0"+t),t}function U(e){var[t,r,s]=e,i=E(t),n=E(r),a=E(s);return"#"+i+n+a}let b=document.getElementById("speedSlider");var m=.001;class ${constructor(t,r,s,i,n,a){this.scientist=s,this.influence=i,this.originX=n,this.originY=a,this.partner=null,this.publisher=null,s?this.color=[0,255,0]:this.color=[255,0,0],this.geometry=r,this.material=new B({color:U(this.color),wireframe:!0}),this.mesh=new P(r,this.material),this.update_color(),this.mesh.position.x=n,this.mesh.position.y=a,this.mesh.name="agent",t.add(this.mesh)}find_partner(t){this.partner=t}move(){this.publisher!=null?(this.moveTowards(this.publisher),this.atEntity(this.publisher)&&this.read()):this.partner!=null?(this.moveTowards(this.partner),this.atEntity(this.partner)&&this.talk()):(this.mesh.position.x+=(this.originX-this.mesh.position.x)/80*b.querySelector("input").value,this.mesh.position.y+=(this.originY-this.mesh.position.y)/80*b.querySelector("input").value,this.mesh.rotation.y+=.01)}moveTowards(t){Math.abs(this.mesh.position.x-t.mesh.position.x)>1&&(this.mesh.position.x+=(t.mesh.position.x-this.mesh.position.x)/50*b.querySelector("input").value),Math.abs(this.mesh.position.y-t.mesh.position.y)>1&&(this.mesh.position.y+=(t.mesh.position.y-this.mesh.position.y)/50*b.querySelector("input").value)}atEntity(t){return Math.abs(this.mesh.position.x-t.mesh.position.x)<=1&&Math.abs(this.mesh.position.y-t.mesh.position.y)<=1}atOrigin(){return Math.abs(this.mesh.position.x-this.originX)<=1&&Math.abs(this.mesh.position.y-this.originY)<=1}read(){var t=this.publisher.publish();t==1?this.scientist?this.influence+=300*m:this.influence+=100*m:this.scientist?this.influence-=50*m:this.influence-=150*m}talk(){const t=this.influence;var r=1;if(this.partner.scientist){var r=1.3;this.partner.influence<0&&(r=r*-1)}if(this.influence+=this.partner.influence*(m*100)*r,this.scientist){var r=1.3;this.influence<0&&(r=r*-1)}this.partner.influence+=t*m*r,this.partner=null}update_color(){var t=this.influence/2+.5;t<0?t=0:t>1&&(t=1),this.color=gsap.utils.interpolate("red","green",t),this.material.color.set(this.color)}}class ee{constructor(t,r,s,i,n,a){this.science_ratio=s,this.posX=t,this.posY=r,this.releases=[];for(var o=0;o<this.science_ratio[0];o++)this.releases.push(1);for(var o=0;o<this.science_ratio[1];o++)this.releases.push(0);this.geometry=n,this.material=a,this.mesh=new P(n,a),this.mesh.name="publisher",this.mesh.position.x=t,this.mesh.position.y=r,i.add(this.mesh)}publish(){return this.releases[Math.round(Math.random()*(this.releases.length-1))]}}let v=document.getElementById("agentSlider"),L=document.getElementById("daySlider"),q=document.getElementById("criticalSlider"),_=document.getElementById("misinformationSlider");function te(){var e=document.getElementById("myBar");f>=g&&k()&&(y=!1,document.getElementById("startBtn").innerHTML="Start"),e.style.width=Math.round(f/g*100)+"%",e.innerHTML="day "+f}var u=new G,c=new N(90,window.innerWidth/window.innerHeight,.1,5e3),w=new V({canvas:document.querySelector("#sim-canvas")});w.setPixelRatio(window.devicePixelRatio);w.setSize(window.innerWidth,window.innerHeight);c.position.setZ(30);c.position.setX(-3);w.render(u,c);var F=new K(16777215);F.position.set(10,10,10);var ie=new Z(16777215,.9);u.add(F,ie);var re=new R(2,3,3),se=new R(2,3,3),ne=new J(10,10,7,11),ae=new B({color:16725401,wireframe:!0});function H(){var e=0,t=0,r=parseInt(_.querySelector("input").value),s=[100-r,r],i=new ee(e,t,s,u,ne,ae);return i}function X(e){for(var t=[],r=[],s=0;s<e;s++)r.push(2*Math.PI/e*s-Math.PI);for(var s=0;s<e;s++){let p=Math.sin(r[s])*e,l=Math.cos(r[s])*e;var i=0,n=!1,a=re;Math.floor(s/e*100)<parseInt(q.querySelector("input").value)&&(n=!0,a=se);var o=new $(u,a,n,i,p,l);t.push(o)}return t}var I=new WeakMap,oe=0;function le(e){return I.has(e)||I.set(e,++oe),I.get(e)}function ue(e){var t=[],r=A(0,2),s=0;d.map(i=>{if(le(i)%2==r){for(;;)if(s=A(0,e),!t.includes(s)){i.find_partner(d[s]),t.push(s);break}}})}function he(){d.map(e=>{e.publisher=M})}function k(){return!d.some(e=>!e.atOrigin())}function C(e){for(let t=u.children.length-1;t>=0;t--)u.children[t].name==e&&u.remove(u.children[t])}function W(){C("agent"),d=X(v.querySelector("input").value),f=0}var d=X(v.querySelector("input").value),f=0,y=!1;document.getElementById("startBtn").addEventListener("click",function(){f>=g&&W(),y?(document.getElementById("startBtn").innerHTML="Start",y=!1):(document.getElementById("startBtn").innerHTML="Stop",y=!0)});var x=v.querySelector("input").value,z=q.querySelector("input").value,g=L.querySelector("input").value,O=_.querySelector("input").value;c.position.z=gsap.utils.mapRange(0,400,10,500,x);var M=H();function D(){requestAnimationFrame(D),(v.querySelector("input").value!=x||q.querySelector("input").value!=z)&&(x=v.querySelector("input").value,z=q.querySelector("input").value,c.position.z=gsap.utils.mapRange(0,400,10,500,x),W()),L.querySelector("input").value!=g&&(g=L.querySelector("input").value),_.querySelector("input").value!=O&&(O=_.querySelector("input").value,C("publisher"),M=H()),k()&&y&&f<=g&&(f+=1,f%7==1&&he(),ue(v.querySelector("input").value)),y?d.map(e=>{e.move(),e.update_color(),e.publisher!=null&&e.atEntity(e.publisher)&&(e.publisher=null)}):d.map(e=>{e.mesh.rotation.x+=.01}),te(),M.mesh.rotation.y+=.001,M.mesh.rotation.z+=.005,w.render(u,c)}function pe(){c.aspect=window.innerWidth/window.innerHeight,c.updateProjectionMatrix(),w.setSize(window.innerWidth,window.innerHeight)}window.addEventListener("resize",pe,!1);D();
